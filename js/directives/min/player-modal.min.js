soccerStats.directive("playerModal",function(e,t,a,r,o,n,i,s){return{restrict:"E",templateUrl:"./templates/directives/player-modal.html",controller:function(e){var t="playerModal";e.closeModal=function(){o.closeModal(t)};var r=s.getCurrentUser();e.parents={},e.update=!1,e.states=s.states,e.$on(i.messages.updatePlayer,function(t,r){a(function(){r.state?(e.update=!0,e.players=s.getPlayerByPlayerId(r.id,function(t){a(function(){e.getParentEmails(t.get("team")),s.getParentByPlayerId(t.id,function(r){a(function(){var a=_.find(e.teamDict,function(e){return e.id==t.get("team").id});e.player={photo:t.get("photo")?t.get("photo")._url:"./img/team-logo-icon.svg",firstName:t.get("firstName"),lastName:t.get("lastName"),birthday:t.get("birthday"),team:a,jerseyNumber:t.get("jerseyNumber"),city:t.get("city"),state:e.states[t.get("state")],emergencyContact:{name:t.get("emergencyContact"),phone:t.get("phone"),relationship:t.get("relationship")},newPhoto:"",id:t.id,parentId:r?r.id:""}})})})})):(e.update=!1,e.player={photo:"./img/team-logo-icon.svg",firstName:"Player",lastName:"Person",birthday:"",team:"",jerseyNumber:"12",city:"Spokane",state:"",emergencyContact:{name:"Alec Moore",phone:"5093336897",relationship:"Father"},newPhoto:"",id:""})})}),e.goToPage=function(e){a(function(){o.goToPage(e)})},e.registerPlayer=function(a){e.update?s.updatePlayer(a,t):o.validateAreaByFormName("playerForm")?s.registerPlayer(a,t,!1):n.error(i.toasts.requiredFields)},e.getParentEmails=function(t){e.parents={},s.getParentEmailsByTeamId(t.id,function(t){a(function(){_.each(t,function(t){e.parents[t.get("email")]=t.id})})})},e.registerTempPlayer=function(a){e.update?s.updatePlayer(a,t):o.validateAreaByFormName("tempPlayerForm")?s.registerPlayer(a,t,!0):n.error(i.toasts.requiredFields)},e.removePlayer=function(e){console.log(e)},e.states=s.states,r&&(e.teamDict=s.getTeams(function(){}))}}});