soccerStats.controller("homeController",function(e,t,a,s,o,l,g,r){e.verified=!1,e.user={name:"",accountType:""},e.myPlayers=[],e.currentTeam={};var n=Parse.User.current();n.fetch()&&(e.user.name=n.get("name"),n.get("emailVerified")?e.verified=!0:o.error(l.toasts.emailVerification)),e.updatePlayer=function(e){r.openModal("playerModal"),a(function(){s.$broadcast(l.messages.updatePlayer,{state:!0,id:e.id})})},e.$on(l.messages.teamChanged,function(t,a){g.getSeasonTeamStats(a.team.id,function(t){if(console.log(t),e.teamStats={teamGames:{data:[]},goalsConceded:0,goalsScored:0,avgGoals:0,ballPossession:0,foulsCommitted:0,gamesPlayed:0,goalsDifference:0,topAssists:[],topGoals:[],topShots:[]},t){var a=t.get("goalsScored")&&t.get("goalsConceded")?t.get("goalsScored")-t.get("goalsConceded"):0;e.teamStats={teamGames:{data:[{value:t.get("gamesDraw")?t.get("gamesDraw"):"",color:"#B4B4B4",highlight:"#B4B4B4",label:"Draws"},{value:t.get("gamesWon"),color:"#5DA97B",highlight:"#5DA97B",label:"Wins"},{value:t.get("gamesDefeat"),color:"#FF7373",highlight:"#FF7373",label:"Losses"}]},goalsConceded:t.get("goalsConceded")?t.get("goalsConceded"):"0",goalsScored:t.get("goalsScored")?t.get("goalsScored"):"0",avgGoals:t.get("avgGoals")?t.get("avgGoals"):"0",ballPossession:t.get("ballPossession")?t.get("ballPossession"):"0",foulsCommitted:t.get("foulsCommitted")?t.get("foulsCommitted"):"0",gamesPlayed:t.get("gamesPlayed")?t.get("gamesPlayed"):"0",goalsDifference:a>=0?"+".concat(a):a,topAssists:[],topGoals:[],topShots:[]},_.each(t.get("topAssists"),function(t){var a=t.get("photo")?t.get("photo")._url:"./img/sample/profile-small.jpg";e.teamStats.topAssists.push({name:t.get("name"),num:t.get("playerStats").get("assists"),photo:a})}),_.each(t.get("topGoals"),function(t){var a=t.get("photo")?t.get("photo")._url:"./img/sample/profile-small.jpg";e.teamStats.topGoals.push({name:t.get("name"),num:t.get("playerStats").get("goals"),photo:a})}),_.each(t.get("topShots"),function(t){var a=t.get("photo")?t.get("photo")._url:"./img/sample/profile-small.jpg";e.teamStats.topShots.push({name:t.get("name"),num:t.get("playerStats").get("shots").total,photo:a})})}})}),e.isCoach=!1,e.$on(l.messages.teamChanged,function(t,a){e.myPlayers=[],a.refresh||(e.currentTeam=a.team),1===n.get("accountType")?g.getPlayersByTeamId(e.currentTeam.id,function(t){_.each(t,function(t){g.getSeasonPlayerStatsByPlayerId(t.get("playerStats").id,function(a){e.myPlayers.push(g.playerConstructor(t,a))})})}):_.each(n.get("players"),function(t){g.getPlayerByPlayerId(t.id,function(t){t.get("team").id===e.currentTeam.id&&g.getSeasonPlayerStatsByPlayerId(t.get("playerStats").id,function(a){e.myPlayers.push(g.playerConstructor(t,a))})})})}),e.$on(l.messages.playerAdded,function(t,a){g.getSeasonPlayerStatsByPlayerId(a.get("playerStats").id,function(t){e.myPlayers.push(g.playerConstructor(a,t))})})});